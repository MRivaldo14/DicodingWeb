importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.5.4/workbox-sw.js"),workbox?(console.log("✅ Workbox loaded"),workbox.precaching.precacheAndRoute([{url:"/",revision:"1"},{url:"/index.html",revision:"1"},{url:"/main.js",revision:"1"},{url:"/styles/style.css",revision:"1"},{url:"/icons/icon-192x192.png",revision:"1"},{url:"/icons/icon-512x512.png",revision:"1"}],{ignoreURLParametersMatching:[/.*/]}),workbox.routing.registerRoute((({url:e})=>"https://story-api.dicoding.dev"===e.origin),new workbox.strategies.NetworkFirst({cacheName:"story-api-cache",networkTimeoutSeconds:10,plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:50,maxAgeSeconds:300}),new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200]})]})),workbox.routing.registerRoute((({request:e})=>"image"===e.destination),new workbox.strategies.CacheFirst({cacheName:"image-cache",plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:60,maxAgeSeconds:2592e3}),new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200]})]})),workbox.routing.registerRoute((({request:e})=>"navigate"===e.mode),new workbox.strategies.NetworkFirst({cacheName:"html-cache",plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:10})]})),workbox.routing.setCatchHandler((async({event:e})=>"document"===e.request.destination?caches.match("/index.html"):Response.error()))):console.log("❌ Workbox gagal dimuat"),self.addEventListener("push",(e=>{const o=e.data?e.data.json():{},i=o.title||"Story App",n={body:o.body||"Anda memiliki notifikasi baru.",icon:"/icons/icon-192x192.png",badge:"/icons/icon-192x192.png",image:o.image||void 0,data:{url:o.url||"/"}};console.log("📬 Push received:",o),e.waitUntil(self.registration.showNotification(i,n))})),self.addEventListener("notificationclick",(e=>{e.notification.close(),e.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then((o=>{for(let i of o)if(i.url===e.notification.data.url&&"focus"in i)return i.focus();if(clients.openWindow)return clients.openWindow(e.notification.data.url)})))}));